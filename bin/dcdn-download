#!/usr/bin/env node

const { start: startDCDN } = require('../')
const { createProgram } = require('../lib/program')
const debug = require('debug')('ara:dcdn:download')

const toLower = x => String(x).toLowerCase()

// yargs program command line interface instance
const program = createProgram({
  usage: `
usage: dcdn download: [-h] [--help]
                 [options]
`,
})

const { argv } = program
  .positional('did', {
    type: 'string',
    describe: 'DID you want to download'
  })

// Emit program usage help
if (0 == argv._.length && argv.help) {
  program.showHelp()
  process.exit(0)
}

// Main program entry
module.exports = (async function main() {
  debug(`starting DCDN to download ${argv.did}`)

  startDCDN({
    quitOnComplete: true,
    did: argv.did,
    download: true,
  })
}())
